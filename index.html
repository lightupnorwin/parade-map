<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Light Up Norwin Parade Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    html, body { height: 100%; margin: 0; }
    #map { height: 100%; width: 100%; }

    /* Disney-ish segmented filter bar */
    .filter-bar {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      padding: 6px 10px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      z-index: 1000;
    }
    .filter-btn {
      border: 2px solid #007aff;
      background: #fff;
      color: #007aff;
      border-radius: 999px;
      padding: 6px 12px;
      font-weight: 700;
      cursor: pointer;
      transition: .2s ease;
      user-select: none;
    }
    .filter-btn.active {
      background: #007aff;
      color: #fff;
    }
    /* Small popup styling */
    .popup h3 {
      margin: 0 0 4px;
      font-size: 16px;
    }
    .popup p {
      margin: 0;
      font-size: 14px;
      line-height: 1.3;
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <div class="filter-bar">
    <button class="filter-btn active" data-category="Restrooms">Restrooms</button>
    <button class="filter-btn active" data-category="Events">Events</button>
    <button class="filter-btn active" data-category="Food">Food &amp; Beverage</button>
    <button class="filter-btn active" data-category="Shopping">Shopping</button>
  </div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // Base map
    const map = L.map('map', { zoomControl: true })
      .setView([40.332, -79.7105], 18);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 20,
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // Category colors (also used on markers)
    const colors = {
      Restrooms: "#007aff",  // blue
      Events:    "#ff3b30",  // red
      Food:      "#34c759",  // green
      Shopping:  "#af52de"   // purple
    };

    // Your current points
    const locations = [
      // Restroom: 415 Main St (corrected)
      {
        position: [40.3314911, -79.710878],
        name: "Restrooms",
        description: "Public restrooms at 415 Main St.",
        category: "Restrooms"
      },
      // Tree Lighting event
      {
        position: [40.332795, -79.710338],
        name: "Tree Lighting",
        description: "At S&amp;T Bank. Ceremony starts at 6 PM.",
        category: "Events"
      },
      // Main Street Stage with a tiny schedule
      {
        position: [40.332008, -79.711068],
        name: "Main Street Stage",
        description: "<strong>Schedule</strong><br>4:00 PM – Band<br>6:00 PM – Band",
        category: "Events"
      },
      // Pretend food vendor
      {
        position: [40.331993, -79.710851],
        name: "Pretend Food Vendor",
        description: "Serving warm treats all evening.",
        category: "Food"
      },
      // Pretend craft vendor
      {
        position: [40.332086, -79.710864],
        name: "Pretend Craft Vendor",
        description: "Handmade gifts and holiday crafts.",
        category: "Shopping"
      }
    ];

    // Build colored circle markers (no external icon URLs)
    const markers = [];
    function addMarker(loc) {
      const marker = L.circleMarker(loc.position, {
        radius: 9,
        weight: 2,
        color: colors[loc.category],   // stroke
        fillColor: colors[loc.category],
        fillOpacity: 0.85
      })
      .bindPopup(
        `<div class="popup">
          <h3>${loc.name}</h3>
          <p>${loc.description}</p>
        </div>`
      );

      marker.category = loc.category;
      marker.addTo(map);
      markers.push(marker);
    }
    locations.forEach(addMarker);

    // Filter logic (toggle buttons)
    const buttons = document.querySelectorAll('.filter-btn');
    buttons.forEach(btn => {
      btn.addEventListener('click', () => {
        btn.classList.toggle('active');
        updateMarkers();
      });
    });

    function updateMarkers() {
      const active = new Set(
        Array.from(buttons)
          .filter(b => b.classList.contains('active'))
          .map(b => b.dataset.category)
      );
      markers.forEach(m => {
        if (active.has(m.category)) {
          m.addTo(map);
        } else {
          map.removeLayer(m);
        }
      });
    }
  </script>
</body>
</html>
