<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Light Up Norwin Parade Map</title>
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet/dist/leaflet.css"
  />
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: Arial, sans-serif;
    }
    #map {
      height: 100%;
      width: 100%;
    }
    .filter-bar {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      background: white;
      border-radius: 12px;
      padding: 6px 10px;
      display: flex;
      gap: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      z-index: 1000;
    }
    .filter-btn {
      border: 2px solid #007aff;
      border-radius: 8px;
      background: white;
      padding: 5px 12px;
      cursor: pointer;
      font-weight: bold;
      color: #007aff;
      transition: all 0.2s ease;
    }
    .filter-btn.active {
      background: #007aff;
      color: white;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <div class="filter-bar">
    <button class="filter-btn active" data-category="Restrooms">Restrooms</button>
    <button class="filter-btn active" data-category="Events">Events</button>
    <button class="filter-btn active" data-category="Food">Food & Beverage</button>
    <button class="filter-btn active" data-category="Shopping">Shopping</button>
  </div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    const map = L.map('map').setView([40.332, -79.7105], 18);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
    }).addTo(map);

    const colors = {
      Restrooms: "blue",
      Events: "red",
      Food: "green",
      Shopping: "purple"
    };

    const locations = [
      {
        position: [40.3314911, -79.710878],
        name: "Restrooms",
        description: "Public Restrooms at 415 Main St",
        category: "Restrooms"
      },
      {
        position: [40.332795, -79.710338],
        name: "Tree Lighting",
        description: "At S&T Bank, starts at 6 PM.",
        category: "Events"
      },
      {
        position: [40.332008, -79.711068],
        name: "Main Street Stage",
        description: "<strong>Schedule:</strong><br>Band – 4 PM<br>Band – 6 PM",
        category: "Events"
      },
      {
        position: [40.331993, -79.710851],
        name: "Pretend Food Vendor",
        description: "Serving delicious treats all night!",
        category: "Food"
      },
      {
        position: [40.332086, -79.710864],
        name: "Pretend Craft Vendor",
        description: "Handmade crafts available here.",
        category: "Shopping"
      }
    ];

    const markers = [];

    function createMarker(loc) {
      const icon = L.icon({
        iconUrl: `https://chart.googleapis.com/chart?chst=d_map_pin_icon&chld=star|${colors[loc.category]}`,
        iconSize: [30, 50],
        iconAnchor: [15, 45],
        popupAnchor: [0, -40],
      });

      const marker = L.marker(loc.position, { icon }).bindPopup(
        `<strong>${loc.name}</strong><br>${loc.description}`
      );
      marker.category = loc.category;
      marker.addTo(map);
      markers.push(marker);
    }

    locations.forEach(createMarker);

    // Filter logic
    const buttons = document.querySelectorAll('.filter-btn');
    buttons.forEach(btn => {
      btn.addEventListener('click', () => {
        btn.classList.toggle('active');
        updateMarkers();
      });
    });

    function updateMarkers() {
      const activeCategories = Array.from(buttons)
        .filter(b => b.classList.contains('active'))
        .map(b => b.dataset.category);

      markers.forEach(m => {
        if (activeCategories.includes(m.category)) {
          m.addTo(map);
        } else {
          map.removeLayer(m);
        }
      });
    }
  </script>
</body>
</html>
